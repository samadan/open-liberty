/*******************************************************************************
 * Copyright (c) 2017, 2025 IBM Corporation and others.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License 2.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *     IBM Corporation - initial API and implementation
 *******************************************************************************/
test {
    dependsOn ':cnf:copyMavenLibs'
    dependsOn ':com.ibm.ws.classloading_test.jarA:jar'
    dependsOn ':com.ibm.ws.classloading_test.jarB:jar'

    def servlet3_1Project = project(':com.ibm.websphere.javaee.servlet.3.1')

    doFirst {
        ant.jar(destfile: new File(compileTestJava.destinationDirectory.getAsFile().get(), 'test.jar'), manifest: file('test-resources/PackageDefineTestResources/MANIFEST.MF')) {
            fileset(dir: compileTestJava.destinationDirectory.getAsFile().get(), includes: "test/,test2/")
        }
    }

    jvmArgs = ["--add-opens", "java.base/java.lang=ALL-UNNAMED",
               "-Dservlet.jar.location=" + servlet3_1Project.configurations.archives.artifacts.files.asPath]
}
