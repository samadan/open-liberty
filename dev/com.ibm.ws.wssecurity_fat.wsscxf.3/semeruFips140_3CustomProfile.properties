# Needed to add a lot of constraints to allow for algorithms used in org.apache.wss4j open source library
# TODO: This file was copied from wsscxf.2's custom profile and then added upon. Revisit later to see which constraints are not needed in wsscxf.3.
# TODO: Revisit this after https://github.com/OpenLiberty/open-liberty/issues/31846
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.desc.name = Custom OpenJCEPlusFIPS Cryptographic Module FIPS 140-3
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.extends = RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Strongly-Enforced
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.2 = sun.security.provider.Sun [+ \
    {KeyStore, JKS, *, ModuleAndFullClassName:java.base/java.security.KeyStore}, \
    {MessageDigest, SHA-1, *, ModuleAndFullClassName:java.base/java.security.KeyStore}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.common.util.KeyUtils}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.common.crypto.CryptoBase}, \
    {MessageDigest, SHA-1, *, FullClassName:org.ehcache.impl.persistence.FileUtils}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.message.WSSecEncryptedKey}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.common.util.UsernameTokenUtil}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.common.derivedKey.P_SHA1}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.message.WSSecSignature}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.message.WSSecDKSign}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.processor.EncryptedKeyProcessor}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.common.crypto.Merlin}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.processor.SignatureProcessor}, \
    {MessageDigest, MD5, *, FullClassName:org.apache.wss4j.dom.message.WSSecSignature}, \
    {MessageDigest, MD5, *, FullClassName:org.apache.wss4j.dom.processor.EncryptedKeyProcessor}]
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.4 = com.sun.crypto.provider.SunJCE [+ \
    {AlgorithmParameters, PBEWithMD5AndDES, *, FullClassName:org.apache.wss4j.dom.message.WSSecSignature}, \
    {AlgorithmParameters, PBEWithMD5AndDES, *, FullClassName:org.apache.wss4j.dom.processor.EncryptedKeyProcessor}, \
    {KeyStore, JCEKS, *, FullClassName:org.apache.wss4j.common.crypto.Merlin}, \
    {Cipher, RSA, *, FullClassName:org.apache.wss4j.common.util.KeyUtils}, \
    {Cipher, AES, *, FullClassName:org.apache.wss4j.dom.message.Encryptor}, \
    {Cipher, AES, *, FullClassName:org.apache.wss4j.dom.util.EncryptionUtils}, \
    {Cipher, DESede, *, FullClassName:org.apache.wss4j.dom.message.Encryptor}, \
    {Cipher, DESede, *, FullClassName:org.apache.wss4j.dom.util.EncryptionUtils}, \
    {Mac, HmacSHA1, *, FullClassName:org.apache.wss4j.common.derivedKey.P_SHA1}, \
    {Mac, HmacSHA1, *, FullClassName:org.apache.wss4j.dom.message.WSSecSignature}, \
    {Mac, HmacSHA1, *, FullClassName:org.apache.wss4j.dom.message.WSSecDKSign}, \
    {Mac, HmacSHA1, *, FullClassName:org.apache.wss4j.dom.processor.SignatureProcessor}, \
    {KeyGenerator, DESede, *, FullClassName:org.apache.wss4j.common.util.KeyUtils}]
# TODO: Allowing all in XMLDSigRI for now. Revisit after Semeru JDK fixes issue with having "#" in the constraint's algorithm name.
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.7 = org.apache.jcp.xml.dsig.internal.dom.XMLDSigRI
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.8 = sun.security.rsa.SunRsaSign [ \
    {Signature, SHA1withRSA, *, FullClassName:org.apache.wss4j.dom.message.WSSecSignature}, \
    {Signature, SHA1withRSA, *, FullClassName:org.apache.wss4j.common.crypto.Merlin}]
